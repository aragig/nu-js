<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>nu.js</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <link rel="stylesheet" href="css/neoux.css">
  <script src="js/neoux.js"></script>
  <script src="js/jquery-3.7.1.js"></script>
</head>
<body>
<div id="nuContents">
  <h1>ぬ - nu.js</h1>

  nu.jsはライブラリに依存しない Vanilla JS で作られているUI補助ツールです。jqueryとの共存も可能です。
  <form id="nuForm">
    <h2 class="mt40">アラート</h2>
    <div class="nuFlexRow gap10 mt30">
      <h3>nu.alert</h3>
      <button id="nuAlertSimple" class="nuButton" type="button">Run</button>
    </div>
    <pre id="nuAlertSimplePre" class="nuCodeBlock"></pre>


    <div class="nuFlexRow gap10 mt30">
      <h3>nu.alert</h3>
        <button id="nuAlert" class="nuButton" type="button">Run</button>
      </div>
    <pre id="nuAlertPre" class="nuCodeBlock" data-html-safe></pre>


    <div class="nuFlexRow gap10 mt30">
      <h3>nu.confirm</h3>
      <button id="nuConfirm" class="nuButton" type="button">Run</button>
    </div>
    <pre id="nuConfirmPre" class="nuCodeBlock"></pre>

    <div class="nuFlexRow gap10 mt30">
      <h3>nu.sheet</h3>
      <button id="nuSheetCustomAlert" class="nuButton" type="button" data-html-safe>Run</button>
    </div>
    <pre id="nuSheetCustomAlertPre" class="nuCodeBlock"></pre>


    <div class="nuFlexRow gap10 mt30">
      <h3>nu.sheet</h3>
      <button id="nuSheet" class="nuButton" type="button" data-html-safe>Run</button>
    </div>
    <pre id="nuSheetPre" class="nuCodeBlock"></pre>


    <h2 class="mt80">ローディングインジケータ</h2>
    <div class="nuFlexRow gap10 mt30">
      <h3>nu.loading</h3>
      <button id="nuLoading" class="nuButton" type="button">Run</button>
    </div>
    <pre class="nuCodeBlock">
nu.loading.show("読み込み中...");

// 3秒後に非表示
setTimeout(() => {
  nu.loading.hide();
}, 3000);
</pre>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        });
    </script>


    <h2 class="mt80">トースト</h2>
    <div class="nuFlexRow gap10 mt30">
      <h3>nu.toast</h3>
      <button id="nuToast" class="nuButton" type="button">Run</button>
    </div>
    <pre class="nuCodeBlock">
nu.toast.show("保存が完了しました！");
</pre>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        });
    </script>


    <div class="nuFlexRow gap10 mt30">
      <h3>nu.toast</h3>
      <button id="nuToastDelay" class="nuButton" type="button">Run</button>
    </div>
    <pre class="nuCodeBlock">
nu.toast.show("エラーが発生しましたエラーが発生しましたエラーが発生しましたエラーが発生しました", 5000); // 5秒表示
</pre>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        });
    </script>


    <h2 class="mt80">ドロップダウンメニュー</h2>
    <div class="nuFlexRow gap10 mt30">
      <h3>nu.dropdown</h3>
      <button id="dropdownBtn" class="nuButton" type="button">Run</button>
    </div>
    <pre class="nuCodeBlock">
nu.dropdown.attach("dropdownBtn",
  [
      {
        label: "設定",
        callback: ()=>console.log("設定")
      },
      {
        label: "ログアウト",
        callback: ()=>console.log("ログアウト")
      }
  ]);
</pre>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        });
    </script>


    <div class="nuFlexSpread gap10 mt30">
      <h3>nu.dropdown</h3>
      <button id="dropdownBtnLeft" class="nuMenuButton" type="button"></button>
    </div>
    <pre class="nuCodeBlock">
nu.dropdown.attach(
  document.getElementById("dropdownBtnLeft"),
  [
      {
        label: "設定",
        callback: () => console.log("設定")
      },
      {
        label: "ログアウト",
        callback: () => console.log("ログアウト")
      }
  ]);
</pre>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        });
    </script>

    <h2 class="mt80">セグメントボタン</h2>
    <div class="nuFlexColumn gap10 mt30">
      <h3>nu.segment</h3>
      <div id="sortSegmentArea"></div>
    </div>
    <pre class="nuCodeBlock">
nu.segment.create(document.getElementById("sortSegmentArea"), {
  id: "sortSegment",
  name: "sampleSortOption",
  value: "最新",
  options: [
      { label: "最新", value: "最新" },
      { label: "人気", value: "人気" },
      { label: "古い順", value: "古い順" }
  ]
}, (val) => console.log("Sort:", val));
</pre>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        });
    </script>

    <div class="nuFlexColumn gap10 mt30">
      <h3>nu.segment</h3>
      <div id="fruitsSegmentArea"></div>
    </div>
    <pre class="nuCodeBlock">
nu.segment.create(document.getElementById("fruitsSegmentArea"), {
  id: "fruitsSegment",
  name: "sampleFruitsOption",
  value: "メロン",
  options: [
      { label: "りんご", value: "りんご" },
      { label: "バナナ", value: "バナナ" },
      { label: "メロン", value: "メロン" }
  ]
}, (val) => console.log("Fruits:", val));
</pre>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        });
    </script>


    <h2 class="mt80">検索ボックス</h2>
    <div class="nuFlexColumn gap10 mt30">
      <h3>nu.search</h3>
      <div id="searchArea"></div>
    </div>
    <pre class="nuCodeBlock">
nu.search.attach(
  document.getElementById("searchArea"),
  "/sample/site_search_index.json"
);
</pre>
<script>
  //------------------------------------------------------------------------------------
  // Submit
  //------------------------------------------------------------------------------------
  document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("nuSubmit").addEventListener("click", () => {
          nu.submit.values(
              document.getElementById("nuForm"),
              (vals) => console.table(vals)
          );
      });
  });
</script>

    <h2 class="mt80">入力欄に対して文字数カウンターを追加する</h2>
    <div class="nuFlexColumn gap10 mt30">
      <h3>nu.charCount</h3>
      <input id="formName" name="name" type="text" class="nuInput" placeholder="お名前を入力してください" autocomplete="on" />
    </div>
    <pre class="nuCodeBlock">
nu.charCount.attach(document.getElementById("formName"), 30);
</pre>

    <div class="nuFlexColumn gap10 mt30">
      <h3>nu.charCount</h3>
      <textarea id="formInquire" name="inquire" class="nuTextarea wFull" placeholder="ご意見・ご感想" rows="5">テキスト</textarea>
    </div>
    <pre class="nuCodeBlock">
nu.charCount.attach(document.getElementById("formInquire"), 300);
</pre>

    <h2 class="mt80">フォーム値取得</h2>
    <div class="nuFlexRow gap10 mt30">
      <h3>nu.submit</h3>
      <button id="nuSubmit" class="nuButton" type="button">Submit</button>
    </div>
    <pre class="nuCodeBlock">
nu.submit.values(
  document.getElementById("nuForm"),
  (vals) => console.table(vals)
);
</pre>

    <hr class="mt80">

    <h2 class="mt40">色々なinput</h2>
    <div class="nuFlexColumn gap20">
      <div>
        <select name="sampleSelect" class="nuSelect">
          <option value="">選択してください</option>
          <option value="a">選択肢A</option>
          <option value="b">選択肢B</option>
        </select>
      </div>
      <div>
        <label>年/月/日：<input name="sampleDate" type="date"></label>
      </div>
      <div>
        <label>年 / 月 / 日 +時:分：<input name="sampleDatetimeLocal" type="datetime-local"></label>
      </div>
      <div>
        <label>カラーパレッド：<input name="sampleColor" type="color" value="#0b80dc"></label>
      </div>
      <div>
        <label>範囲を選択：<input name="sampleRange" type="range" min="0" max="100"></label>
      </div>
    </div>

  </form>
</div>


<script>
    document.addEventListener("DOMContentLoaded", () => {
        "use strict";

        //------------------------------------------------------------------------------------
        // カスタムアラート
        //------------------------------------------------------------------------------------
        {
            const code = `
$("#nuAlertSimple").click(function() {
    nu.alert("メッセージ");
});`.trim();

            // 表示用
            document.getElementById("nuAlertSimplePre").textContent = code;

            // 実行用
            new Function(code)();
        }

        {
            const message = `<b>HTML</b>で装飾できます。<br>
なんと<br>
画像表示も可能！<br>
↓<br>
<a href="https://araisun.com/" target="_blank"><img src="https://araisun.com/img/site-logo.jpg"></a>`;

            document.getElementById("nuAlert").addEventListener("click", () => {
                nu.alert(message, function() {
                    console.log("ok");
                });
            });
            document.getElementById("nuAlertPre").innerHTML = `const message = \`<b>HTML</b>で装飾できます。<br>
なんと<br>
画像表示も可能！<br>
↓<br>
<a href="https://araisun.com/" target="_blank"><img src="https://araisun.com/img/site-logo.jpg"></a>\`;

nu.alert(message, function() {
    console.log("ok");
});`;
        }


        {
            document.getElementById("nuConfirm").addEventListener("click", () => {
                nu.confirm("This is some message area.", function() {
                    console.log("ok");
                }, function() {
                    console.log("cancel");
                });
            });
            document.getElementById("nuConfirmPre").textContent = `nu.confirm("This is some message area.", function() {
    console.log("ok");
}, function() {
    console.log("cancel");
});`;
        }

        {
            const items = [
                { label: "いいえ",    callback: () => console.log("いいえ") },
                { label: "はい",    callback: () => console.log("はい") }
            ];
            document.getElementById("nuSheetCustomAlert").addEventListener("click", () => {
                nu.sheet("アラートをカスタマイズ", items);
            });
            document.getElementById("nuSheetCustomAlertPre").textContent = `const items = ${JSON.stringify(items)}
nu.sheet("アラートをカスタマイズ", items);`;
        }


        {
            //TODO: jsonにcallbackのようなロジックを含めるべきではない
            // →「データとロジックを分離」する
            const items = [
                { label: "編集",    callback: () => console.log("編集") },
                { label: "削除",    callback: () => console.log("削除") },
                { label: "複製",    callback: () => console.log("複製") },
                { label: "キャンセル", callback: null }
            ];
            document.getElementById("nuSheet").addEventListener("click", () => {
                nu.sheet("操作を選んでください", items);
            });
            document.getElementById("nuSheetPre").textContent = `const items = ${JSON.stringify(items)}
nu.sheet("操作を選んでください", items);`;
        }

        //------------------------------------------------------------------------------------
        // ローディングインジケータ
        //------------------------------------------------------------------------------------
        document.getElementById("nuLoading").addEventListener("click", () => {
            nu.loading.show("読み込み中...");

            // 3秒後に非表示
            setTimeout(() => {
                nu.loading.hide();
            }, 3000);
        });

        //------------------------------------------------------------------------------------
        // トースト通知
        //------------------------------------------------------------------------------------
        document.getElementById("nuToast").addEventListener("click", () => {
            nu.toast.show("保存が完了しました！");
        });

        document.getElementById("nuToastDelay").addEventListener("click", () => {
            nu.toast.show("エラーが発生しました<br>エラーが発生しましたエラーが発生しましたエラーが発生しました", 5000); // 5秒表示
        });


        //------------------------------------------------------------------------------------
        // ドロップダウンメニュー
        //------------------------------------------------------------------------------------
        nu.dropdown.attach("dropdownBtn",
            [
                { label: "設定", callback: () => console.log("設定") },
                { label: "ログアウト", callback: () => console.log("ログアウト") }
            ]);


        nu.dropdown.attach(
            document.getElementById("dropdownBtnLeft"),
            [
                { label: "設定", callback: () => console.log("設定") },
                { label: "ログアウト", callback: () => console.log("ログアウト") }
            ]);


        //------------------------------------------------------------------------------------
        // セグメントボタン
        //------------------------------------------------------------------------------------
        nu.segment.create(document.getElementById("sortSegmentArea"), {
            id: "sortSegment",
            name: "sampleSortOption",
            value: "最新",
            options: [
                { label: "最新", value: "最新" },
                { label: "人気", value: "人気" },
                { label: "古い順", value: "古い順" }
            ]
        }, (val) => console.log("Sort:", val));

        nu.segment.create(document.getElementById("fruitsSegmentArea"), {
            id: "fruitsSegment",
            name: "sampleFruitsOption",
            value: "メロン",
            options: [
                { label: "りんご", value: "りんご" },
                { label: "バナナ", value: "バナナ" },
                { label: "メロン", value: "メロン" }
            ]
        }, (val) => console.log("Fruits:", val));


        //------------------------------------------------------------------------------------
        // 検索ボックス
        //------------------------------------------------------------------------------------
        nu.search.attach(document.getElementById("searchArea"), "/sample/site_search_index.json");


        //------------------------------------------------------------------------------------
        // 入力欄に対して文字数カウンターを追加する
        //------------------------------------------------------------------------------------
        nu.charCount.attach(document.getElementById("formName"), 30);
        nu.charCount.attach(document.getElementById("formInquire"), 300);




        function escapeHtml(str) {
            return str
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
        document.querySelectorAll('pre.nuCodeBlock[data-html-safe]').forEach(pre => {
            const raw = pre.innerHTML.trim();
            pre.innerHTML = escapeHtml(raw);
        });

    });
</script>

</body>
</html>