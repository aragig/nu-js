<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>neoux.js</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <link rel="stylesheet" href="css/neoux.css">
    <script src="js/neoux.js"></script>
</head>
<body>
<h1>neoux.js</h1>
<form id="nuForm">
    <h2 class="mt50">アラート</h2>
    <h3 class="mt30">neoux.alert: </h3>
    <button id="nuAlert" class="nuButton" type="button">Alert</button>

    <pre class="nuCodeBlock" data-exec>
document.getElementById("nuAlert").addEventListener("click", () => {
    neoux.alert("This is some message area.<br><b>HTML</b>で装飾できます。", function() {
        console.log("ok");
    });
});
</pre>


    <h3 class="mt30">neoux.confirm: </h3>
    <button id="nuConfirm" class="nuButton" type="button">Confirm</button>
    <pre class="nuCodeBlock" data-exec>
document.getElementById("nuConfirm").addEventListener("click", () => {
    neoux.confirm("This is some message area.", function() {
        console.log("ok");
    }, function(ans) {
        console.log("cancel");
    });
});
</pre>


    <h3 class="mt30">neoux.sheet: </h3>
    <button id="nuSheet" class="nuButton" type="button">Sheet</button>
    <pre class="nuCodeBlock" data-exec>
document.getElementById("nuSheet").addEventListener("click", () => {
    neoux.sheet("操作を選んでください", [
        { label: "編集",    callback: () => console.log("編集") },
        { label: "削除",    callback: () => console.log("削除") },
        { label: "複製",    callback: () => console.log("複製") },
        { label: "キャンセル", callback: null }
    ]);
});
</pre>


    <h2 class="mt50">ローディングインジケータ</h2>
    <h3 class="mt30">neoux.loading: </h3>
    <button id="nuLoading" class="nuButton" type="button">Indicator</button>
    <pre class="nuCodeBlock" data-exec>
document.getElementById("nuLoading").addEventListener("click", () => {
    neoux.loading.show("読み込み中...");

    // 3秒後に非表示
    setTimeout(() => {
        neoux.loading.hide();
    }, 3000);
});
</pre>


    <h2 class="mt50">トースト</h2>
    <h3 class="mt30">neoux.toast: </h3>
    <pre class="nuCodeBlock" data-exec>
document.getElementById("nuToast").addEventListener("click", () => {
    neoux.toast.show("保存が完了しました！");
});
</pre>
    <button id="nuToast" class="nuButton" type="button">Toast</button>
    <h3 class="mt30">neoux.toast: </h3>
    <pre class="nuCodeBlock" data-exec>
document.getElementById("nuToastDelay").addEventListener("click", () => {
    neoux.toast.show("エラーが発生しましたエラーが発生しましたエラーが発生しましたエラーが発生しました", 5000); // 5秒表示
});
</pre>

    <button id="nuToastDelay" class="nuButton" type="button">Toast with delay</button>

    <h2 class="mt50">ドロップダウンメニュー</h2>
    <div style="display:flex; justify-content:space-between;">
        <button id="dropdownBtn" class="nuButton" type="button">Menu</button>
        <button id="dropdownBtnLeft" class="nuMenuButton" type="button"></button>
    </div>

    <h2 class="mt50">UISegmentedControl風ラジオボタン</h2>
    <div class="nuFlexColumn gap10">
        <div id="sortSegmentArea"></div>
        <div id="fruitsSegmentArea"></div>
    </div>

    <h2 class="mt50">検索ボックス</h2>
    <div id="searchArea"></div>



    <h2 class="mt50">色々なinput</h2>
    <div class="nuFlexColumn gap20">
        <div>
            <input id="formName" name="name" type="text" class="nuInput" placeholder="お名前を入力してください" autocomplete="on" />
        </div>
        <div>
            <textarea id="formInquire" name="inquire" class="nuTextarea wFull" placeholder="ご意見・ご感想" rows="5">テキスト</textarea>
        </div>
        <div>
            <select name="sampleSelect" class="nuSelect">
                <option value="">選択してください</option>
                <option value="a">選択肢A</option>
                <option value="b">選択肢B</option>
            </select>
        </div>
        <div>
            <label>年/月/日：<input name="sampleDate" type="date"></label>
        </div>
        <div>
            <label>年 / 月 / 日 +時:分：<input name="sampleDatetimeLocal" type="datetime-local"></label>
        </div>
        <div>
            <label>カラーパレッド：<input name="sampleColor" type="color" value="#0b80dc"></label>
        </div>
        <div>
            <label>範囲を選択：<input name="sampleRange" type="range" min="0" max="100"></label>
        </div>
    </div>

    <h2 class="mt50">フォーム値取得</h2>
    <div>
        <button id="nuSubmit" class="nuButton" type="button">Submit</button>
    </div>
</form>

<script>
    document.addEventListener("DOMContentLoaded", () => {

        // TODO このロジックをneouxで実装して汎用的にする
        document.querySelectorAll('pre.nuCodeBlock[data-exec]').forEach((pre, index) => {
            // localStorageキーを生成
            const storageKey = `nuCodeVisible_${index}`;
            const isVisible = localStorage.getItem(storageKey) === 'true';

            // トグルボタンを作成して挿入
            const toggleBtn = document.createElement('button');
            toggleBtn.type = 'button';
            toggleBtn.id = `nuCodeToggle${index}`;
            toggleBtn.className = 'nuCodeToggle';
            toggleBtn.textContent = isVisible ? 'Close' : 'Source Code';
            pre.parentNode.insertBefore(toggleBtn, pre);

            // 初期状態: collapsedクラスで非表示に
            if (!isVisible) {
                pre.classList.add('collapsed');
            }

            // ボタンクリックで開閉＆状態保存
            toggleBtn.addEventListener('click', () => {
                const nowVisible = !pre.classList.contains('collapsed');
                if (nowVisible) {
                    pre.classList.add('collapsed');
                    toggleBtn.textContent = 'Source Code';
                    localStorage.setItem(storageKey, 'false');
                } else {
                    pre.classList.remove('collapsed');
                    toggleBtn.textContent = 'Close';
                    localStorage.setItem(storageKey, 'true');
                }
            });

            // ソースをトリムして実行（元の動作を維持）
            pre.textContent = pre.textContent.trim();
            const fn = new Function(pre.textContent);
            fn();
        });



        //------------------------------------------------------------------------------------
        // ドロップダウンメニュー
        //------------------------------------------------------------------------------------
        neoux.dropdown.attach(
            document.getElementById("dropdownBtn"),
            [
                { label: "設定", callback: () => console.log("設定") },
                { label: "ログアウト", callback: () => console.log("ログアウト") }
            ]);


        neoux.dropdown.attach(
            document.getElementById("dropdownBtnLeft"),
            [
                { label: "設定", callback: () => console.log("設定") },
                { label: "ログアウト", callback: () => console.log("ログアウト") }
            ]);


        //------------------------------------------------------------------------------------
        // UISegmentedControl風 ラジオグループ呼び出し
        //------------------------------------------------------------------------------------
        neoux.segment.create(document.getElementById("sortSegmentArea"), {
            id: "sortSegment",
            name: "sampleSortOption",
            value: "最新",
            options: [
                { label: "最新", value: "最新" },
                { label: "人気", value: "人気" },
                { label: "古い順", value: "古い順" }
            ]
        }, (val) => console.log("Sort:", val));

        neoux.segment.create(document.getElementById("fruitsSegmentArea"), {
            id: "fruitsSegment",
            name: "sampleFruitsOption",
            value: "メロン",
            options: [
                { label: "りんご", value: "りんご" },
                { label: "バナナ", value: "バナナ" },
                { label: "メロン", value: "メロン" }
            ]
        }, (val) => console.log("Fruits:", val));


        //------------------------------------------------------------------------------------
        // 検索ボックス
        //------------------------------------------------------------------------------------
        neoux.search.attach(document.getElementById("searchArea"), "/sample/site_search_index.json");


        //------------------------------------------------------------------------------------
        // 入力欄に対して文字数カウンターを追加する
        //------------------------------------------------------------------------------------
        neoux.charCount.attach(document.getElementById("formName"), 30);
        neoux.charCount.attach(document.getElementById("formInquire"), 300);


        //------------------------------------------------------------------------------------
        // Submit
        //------------------------------------------------------------------------------------
        document.getElementById("nuSubmit").addEventListener("click", () => {
            neoux.submit.values(
                document.getElementById("nuForm"),
                (vals) => console.table(vals)
            );
        });

    });
</script>

</body>
</html>