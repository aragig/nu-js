document.addEventListener("DOMContentLoaded", () => {
	"use strict";

	//TODO ä»¥ä¸‹ã¯ã€å®Ÿé¨“çš„ãªã®ã§ä¸è¦ãªã‚‰å‰Šé™¤ã™ã‚‹
	nu.d.begin("ğŸš€Welcome to nu.js !");
	nu.d.log("ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸");
	// nu.d.warn("è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸");
	// nu.d.error("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ");
	// nu.d.info("ã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³");
	nu.d.json("jojo.json", {
		"name": "ç©ºæ¡æ‰¿å¤ªéƒ",
		"stand": "ã‚¶ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰"
	});

	nu.d.end();

	//------------------------------------------------------------------------------------
	// ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆ ã‚‚ã£ã¨ã‚‚ã‚·ãƒ³ãƒ—ãƒ«
	//------------------------------------------------------------------------------------
	{
		const code = `
$("#__nuAlertSimple button").click(function() {
	nu.alert("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸");
});
            `.trim();

		$("#__nuAlertSimple pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}

	//------------------------------------------------------------------------------------
	// ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆã€€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’HTMLã§è£…é£¾
	//------------------------------------------------------------------------------------
	{
		const code = `
const message=\`
<b>HTML</b>ã§è£…é£¾ã§ãã¾ã™ã€‚<br>
ãªã‚“ã¨<br>
ç”»åƒè¡¨ç¤ºã‚‚å¯èƒ½ï¼<br>
â†“<br>
<a href="https://araisun.com/" target="_blank">
	<img src="https://araisun.com/img/site-logo.jpg">
</a>
\`.trim();

$("#__nuAlert button").click(function() {
	nu.alert(message, function() {
		nu.toast("Clicked OK");
	});
});
            `.trim();

		$("#__nuAlert pre").html(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}


	//------------------------------------------------------------------------------------
	// ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆã€€äºŒã¤ã®ãƒœã‚¿ãƒ³ --OKã¨ã‚­ãƒ£ãƒ³ã‚»ãƒ«
	//------------------------------------------------------------------------------------
	{
		const code = `
$("#__nuConfirm button").click(function() {
	nu.confirm("ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆ", function() {
		nu.toast("Clicked OK");
	}, function() {
		nu.toast("Clicked ã‚­ãƒ£ãƒ³ã‚»ãƒ«");
	});
});
            `.trim();

		$("#__nuConfirm pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}


	//------------------------------------------------------------------------------------
	// ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆã€€äºŒã¤ã®ãƒœã‚¿ãƒ³ --ãƒœã‚¿ãƒ³ã®åå‰ã‚’è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
	//------------------------------------------------------------------------------------
	{
		const code = `
$("#__nuSheetAlert button").click(function() {
	nu.sheet("å‰Šé™¤ã—ã¾ã™ãŒã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ",
		{cancel:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«",delete:"å‰Šé™¤"},{
			onCancel: function() {
				nu.toast("Clicked ã‚­ãƒ£ãƒ³ã‚»ãƒ«");
			},
			onDelete: function() {
				nu.toast("Clicked å‰Šé™¤", { type:"error"});
			}
	});
});
            `.trim();

		$("#__nuSheetAlert pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}


	//------------------------------------------------------------------------------------
	// ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆã€€ï¼“ã¤ä»¥ä¸Šã®ãƒœã‚¿ãƒ³ --ã‚·ãƒ¼ãƒˆè¡¨ç¾
	//------------------------------------------------------------------------------------
	{
		const code = `
const items = {
  edit: "ç·¨é›†",
  duplicate: "è¤‡è£½",
  delete: "å‰Šé™¤",
  cancel: "ã‚­ãƒ£ãƒ³ã‚»ãƒ«"
};

$("#__nuSheet button").click(function() {
	nu.sheet("æ“ä½œã‚’é¸ã‚“ã§ãã ã•ã„", items, {
		onEdit: function() {
			nu.toast("clicked ç·¨é›†")
		},
		onDuplicate: function() {
			nu.toast("clicked è¤‡è£½")
		},
		onDelete: function() {
			nu.toast("clicked å‰Šé™¤");
		},
		onCancel: function() {
			nu.toast("clicked ã‚­ãƒ£ãƒ³ã‚»ãƒ«");
		}
	});
});
            `.trim();

		$("#__nuSheet pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨

	}

	//------------------------------------------------------------------------------------
	// ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿
	//------------------------------------------------------------------------------------
	{
		const code = `
$("#__nuLoading button").click(function() {
	nu.loading.show("èª­ã¿è¾¼ã¿ä¸­...");

	// 3ç§’å¾Œã«éè¡¨ç¤º
	setTimeout(() => {
		nu.loading.hide();
	}, 3000);
});
            `.trim();

		$("#__nuLoading pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}


	//------------------------------------------------------------------------------------
	// ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã€€ãã®1
	//------------------------------------------------------------------------------------
	{
		const code = `
$("#__nuToast button").click(function() {
	nu.toast("ä¿å­˜ãŒå®Œäº†ã—ã¾ã—ãŸï¼");
});
            `.trim();

		$("#__nuToast pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}

	//------------------------------------------------------------------------------------
	// ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã€€ãã®2
	//------------------------------------------------------------------------------------
	{
		const code = `
$("#__nuToastDelay button").click(function() {
	const longMessage = "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ";

	nu.toast(longMessage,
	{
		duration: 5000, // 5ç§’é–“è¡¨ç¤º
		type: "error",
		position: "top"
	});
});
            `.trim();

		$("#__nuToastDelay pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}


	//------------------------------------------------------------------------------------
	// ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€€ãã®ï¼‘
	//------------------------------------------------------------------------------------
	{
		// TODO $("#__nuMenuTrigger button").click ã®å½¢ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„
		const code = `
nu.menu("__nuMenuTriggerBtn", {
		success: "æˆåŠŸ",
		error: "ã‚¨ãƒ©ãƒ¼",
		warning: "è­¦å‘Š",
		info: "ã‚¤ãƒ³ãƒ•ã‚©",
	}, {
	onSuccess: function () {
		nu.toast.s("Clicked æˆåŠŸ");
	},
	onError: function () {
		nu.toast.e("Clicked ã‚¨ãƒ©ãƒ¼");
	},
	onWarning: function () {
		nu.toast.w("Clicked è­¦å‘Š");
	},
	onInfo: function () {
		nu.toast.i("Clicked ã‚¤ãƒ³ãƒ•ã‚©");
	}
});
            `.trim();

		$("#__nuMenuTrigger pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}

	//------------------------------------------------------------------------------------
	// ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€€ãã®2 --ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã‚¿ã‚¤ãƒ—
	//------------------------------------------------------------------------------------
	{
		const code = `
nu.menu("__nuMenuTriggerRBtn", {
		hoge: "ã»ã’",
		fuga: "ãµãŒ",
		pico: "ã´ã“"
	}, {
	onHoge: function () {
		nu.toast("clicked ã»ã’");
	},
	onFuga: function () {
		nu.toast("clicked ãµãŒ");
	},
	onPico: function () {
		nu.toast("clicked ã´ã“");
	}
});
            `.trim();

		$("#__nuMenuTriggerR pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}


	//------------------------------------------------------------------------------------
	// ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰UI
	//------------------------------------------------------------------------------------
	{
		const code = `
nu.upload("uploadArea", {
	maxSize: 1024 * 1024, // 1MBã¾ã§
	url: "/api/upload/image"
}, {
	onError: function (msg) {
		nu.toast.e("ã‚¨ãƒ©ãƒ¼: " + msg);
	},
	onSuccess: function(msg) {
		nu.toast.s("ç™»éŒ²å®Œäº†: "+ msg);
	}
});
`.trim();

		$("#__nuUpload pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}

	//------------------------------------------------------------------------------------
	// ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒœã‚¿ãƒ³ã€€ãã®ï¼‘
	//------------------------------------------------------------------------------------
	{
		const code = `
nu.segment("__nuSegmentSortBtns", {
	name: "sampleSortOption",
	value: "æœ€æ–°",
	options: [
		{ label: "æœ€æ–°", value: "æœ€æ–°" },
		{ label: "äººæ°—", value: "äººæ°—" },
		{ label: "å¤ã„é †", value: "å¤ã„é †" }
	]
}, {
	onChange: (val) => nu.toast(val)
});
            `.trim();


		$("#__nuSegmentSort pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}


	//------------------------------------------------------------------------------------
	// ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒœã‚¿ãƒ³ã€€ãã®ï¼’
	//------------------------------------------------------------------------------------
	{
		const code = `
nu.segment("__nuSegmentFruitsBtns", {
	name: "sampleFruitsOption",
	value: "ãƒ¡ãƒ­ãƒ³",
	options: [
		{ label: "ã‚Šã‚“ã”", value: "ã‚Šã‚“ã”" },
		{ label: "ãƒãƒŠãƒŠ", value: "ãƒãƒŠãƒŠ" },
		{ label: "ãƒ¡ãƒ­ãƒ³", value: "ãƒ¡ãƒ­ãƒ³" }
	]
}, {
	onChange: (val) => nu.toast(val)
});
            `.trim();

		$("#__nuSegmentFruits pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}



	//------------------------------------------------------------------------------------
	// æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹
	//------------------------------------------------------------------------------------
	{
		const code = `
nu.search("__nuSearchBox", "/sample/site_search_index.json", {
	onConfirm: function (text) {
		nu.toast("ğŸ”æ¤œç´¢ç¢ºå®š: " + text, {position: "top"});
	},
	onBlur: function (text) {
		nu.toast("ğŸ”ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¢ã‚¦ãƒˆ: " + text, {position: "top"});
	}
});
`.trim();
		$("#__nuSearch pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}


	//------------------------------------------------------------------------------------
	// å…¥åŠ›æ¬„ã«å¯¾ã—ã¦æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã€€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
	//------------------------------------------------------------------------------------
	{
		const code = `nu.count("__nuCountInputTarget", 30);`;
		$("#__nuCountInput pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}

	//------------------------------------------------------------------------------------
	// å…¥åŠ›æ¬„ã«å¯¾ã—ã¦æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã€€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢
	//------------------------------------------------------------------------------------
	{
		const code = `nu.count("__nuCountTextareaTarget", 140);`;
		$("#__nuCountTextarea pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨
	}



	//------------------------------------------------------------------------------------
	// Submit
	//------------------------------------------------------------------------------------
	{
		const code = `
$("#__nuVals button").click(function() {
	const res = nu.vals("__nuForm");
	const jstr = JSON.stringify(res, null , 2);
	$("#nuSubmitRestArea").text(jstr);
	nu.d.table("nu.formData", res);
});
            `.trim();

		$("#__nuVals pre").text(code); // è¡¨ç¤ºç”¨
		new Function(code)(); // å®Ÿè¡Œç”¨

	}


	//------------------------------------------------------------------------------------
	// è¡¨ç¤ºç”¨è£œåŠ©ãƒ„ãƒ¼ãƒ«ã€€HTMLã‚³ãƒ¼ãƒ‰ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã›ã‚‹
	//------------------------------------------------------------------------------------
	function escapeHtml(str) {
		return str
			.replace(/&/g, "&amp;")
			.replace(/</g, "&lt;")
			.replace(/>/g, "&gt;")
			.replace(/"/g, "&quot;")
			.replace(/'/g, "&#039;");
	}
	document.querySelectorAll('pre.nuCodeBlock[data-html-safe]').forEach(pre => {
		const raw = pre.innerHTML.trim();
		pre.innerHTML = escapeHtml(raw);
	});

});